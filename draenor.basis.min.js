/*
*  Copyright 2014-01-01
*  Author wenren
*  Dependent 依赖于zepto.js，mobile端web modules*/

!function(a){var b=function(b,c,d){if("undefined"==typeof c){var e=null;if(document.cookie&&""!=document.cookie)for(var f=document.cookie.split(";"),g=0;g<f.length;g++){var h=a.trim(f[g]);if(h.substring(0,b.length+1)==b+"="){e=decodeURIComponent(h.substring(b.length+1));break}}return e}d=d||{},null===c&&(c="",d=a.extend({},d),d.expires=-1);var i="";if(d.expires&&("number"==typeof d.expires||d.expires.toUTCString)){var j;"number"==typeof d.expires?(j=new Date,j.setTime(j.getTime()+60*d.expires*60*1e3)):j=d.expires,i="; expires="+j.toUTCString()}var k=d.path?"; path="+d.path:"",l=d.domain?"; domain="+d.domain:"",m=d.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(c),i,k,l,m].join("")};a.cookie={setCookie:function(a,c,d){var e=d;e||(e={path:"/",expires:1}),b(a,c,d)},getCookie:function(a){return a?b(a):!1},deleteCookie:function(b){var c=new Date;c.setTime(c.getTime()-864e5),a.cookie.setCookie(b,"",c)},isExists:function(b){var c=a.cookie.getCookie(b);try{return"string"===a.type(c)?0!==c.length?!0:!1:!1}catch(d){console.info("error"+d)}}},a.gotoPage=function(b,c,d){var e,f,g,h=a.parseUrl(),i={id:!0,type:!0};if(h&&(g=a.parseJSON(h)),b)c?("string"==typeof c?e=a.parseJSON(c):(e=g,c=h),"object"===a.type(e)?d?g&&(f=a.stringify(a.extend(g,e))):f=c:f=""):f="";else if(g.history){b=g.history;for(var j in g)i[j]||delete g[j];f=a.stringify(g)}window.location.href=b+f}}(Zepto);
!function(a){a.dateParse=function(b){var c,d,e=/^-[1-9]\d*$/,f=/\.\d/;if("number"===a.type(b)){d=new Date(b);var g={M:d.getMonth()+1,d:d.getDate(),h:d.getHours(),m:d.getMinutes(),s:d.getSeconds(),q:Math.floor((d.getMonth()+3)/3),S:d.getMilliseconds(),parse:d.getTime(),ye:d.getFullYear()}}c=new Date;var h={M:c.getMonth()+1,d:c.getDate(),h:c.getHours(),m:c.getMinutes(),s:c.getSeconds(),q:Math.floor((c.getMonth()+3)/3),S:c.getMilliseconds(),parse:c.getTime(),ye:c.getFullYear()};return{parseTime:function(){var a,b,c,d,i,j,k,l=h.parse-g.parse,m="";if(e.test(l))return"时间毫秒差为负数";if(c=Math.floor(l/864e5))if(b=Math.floor(c/30))if(a=Math.floor(b/12)){var n=f.exec(b/12);n&&(k=n[0].replace(/\./,"")+"前"),m+=a+"年"+(k||"前")}else{var o=f.exec(c/30);o&&(k=o[0].replace(/\./,"")+"前"),m+=b+"月"+(k||"前")}else m+=c+"天前";else d=Math.floor(l/36e5),d?m+=d+"小时前":(i=Math.floor(l/6e4),i?m+=i+"分钟前":(j=Math.floor(l/1e3),m+=j+"秒前"));return m},Format:function(a){var b={0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(h.ye+"").substr(4-RegExp.$1.length))),/(E+)/.test(a)&&(a=a.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+b[this.getDay()+""]));for(var c in h)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?h[c]:("00"+h[c]).substr((""+h[c]).length)));return a},time:h}}}(Zepto);
!function(a){var b=function(b,c,d){var e={status:b,message:c};a.storage.set("geolocation",a.stringify(e)),"function"==typeof d&&d(e)},c=function(c){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(b){var d={latitude:b.coords.latitude,longitude:b.coords.longitude};a.storage.set("geolocation",a.stringify(d)),"function"==typeof c&&c(d)},function(a){switch(a.code){case 0:b(0,a.message,c);break;case 1:b(1,a.message,c);break;case 2:b(2,a.message,c);break;case 3:b(3,a.message,c)}})};a.geolocationSarat=function(a,b){a&&navigator.geolocation&&c(b)}}(Zepto);
!function(a){var b,c=localStorage,d=[],e=sessionStorage,f=window.location;a.PATH={host:"http://"+f.host+"/"},a.DOMcollection={};var g=function(c,e){var f=c;b=0,f.forEach(function(a){d.push({status:0,location:a,connector:k(a)})}),d.cmdMap={},window.addEventListener("message",function(c){var f=c.data;d.cmdMap["message_"+b]=a.parseJSON(f),b===d.length-1&&e(d.cmdMap),b++},!1)},h=function(a,b,d){d?e.setItem(a,b):c.setItem(a,b)},i=function(a,b){return b?e.getItem(a):c.getItem(a)},j=function(a,b){return b?null===e.getItem(a)||void 0===e.getItem(a)?!1:!0:null===c.getItem(a)||void 0===c.getItem(a)?!1:!0},k=function(a){var b=document.createElement("iframe");return b.style.display="none",b.src=a,document.body.appendChild(b),b.contentWindow},l=function(b,c){var d,e=b;e.forEach(function(b,e){d="object"===a.type(c[e])||"array"===a.type(c[e])?JSON.stringify(c[e]):c[e],window.parent.postMessage(d,b)})},m=function(a,b){b?e.removeItem(a):c.removeItem(a)},n=function(a){a?e.clear():c.clear()};a.storage={receiveMessage:g,set:h,get:i,isExists:j,postMessage:l,remove:m,clear:n},a.parseUrl=function(){var a,b=window.location.href,c=/(\?|\#)(.+)/,d=c.exec(b);return a=null!==d?decodeURI(d[2]):!1},a.stringify=function(a){return JSON.stringify(a)};var o=function(a){function b(a,b){if(b=b.replace(/\{|\(|\)|\}|-/g,""),b=b.toLowerCase(),32!=b.length||-1!=b.search(/[^0-9,a-f]/i))c(a);else for(var d=0;d<b.length;d++)a.push(b[d])}function c(a){for(var b=32;b--;)a.push("0")}function d(a,b){switch(b){case"N":return a.toString().replace(/,/g,"");case"D":var c=a.slice(0,8)+"-"+a.slice(8,12)+"-"+a.slice(12,16)+"-"+a.slice(16,20)+"-"+a.slice(20,32);return c=c.replace(/,/g,"");case"B":var c=d(a,"D");return c="{"+c+"}";case"P":var c=d(a,"D");return c="("+c+")";default:return new o}}var e=new Array;"string"==typeof a?b(e,a):c(e),this.Equals=function(a){return a&&a.IsGuid?this.ToString()==a.ToString():!1},this.IsGuid=function(){},this.ToString=function(a){return"string"==typeof a?"N"==a||"D"==a||"B"==a||"P"==a?d(e,a):d(e,"D"):d(e,"D")}},p=function(){for(var a="",b=32;b--;)a+=Math.floor(16*Math.random()).toString(16);return new o(a)},q=p();a.guid=q;var r=function(){var b=a("body"),c='<div id="backdrop" class="modal-backdrop fade in" style="display:none;"></div><div class="error" id="error_parent" style="display:none;"><h1 id="error_content"></h1></div>';b.append(c),a.DOMcollection.backdrop=a("#backdrop");var d=a("#error_content"),e=a("#error_parent");return{show:function(b){a.DOMcollection.backdrop.show(),d.html(b),e.show()},hide:function(b){setTimeout(function(){a.DOMcollection.backdrop.hide(),e.hide(),"function"==typeof b&&b()},2e3)}}};a.error=r();var s=function(){var b=a("body"),c='<div class="wait" id="wait" style="display:none;"><img src='+a.PATH.host+"css/img/loading.gif></div>";b.append(c);var d=a("#wait");return{show:function(){a.DOMcollection.backdrop.show(),d.show()},hide:function(b){a.DOMcollection.backdrop.hide(),d.hide(),"function"==typeof b&&b()}}};a.wait=s()}(Zepto);
!function(a){a.transformX=function(a,b,c,d){var e=a[b],f=e&&e.style;f&&(f.webkitTransitionDuration=f.MozTransitionDuration=f.msTransitionDuration=f.OTransitionDuration=f.transitionDuration=d+"ms",f.webkitTransform="translate("+c+"px,0)translateZ(0)",f.msTransform=f.MozTransform=f.OTransform="translateX("+c+"px)")},a.transformY=function(a,b,c,d){var e=a[b],f=e&&e.style;f&&(f.webkitTransitionDuration=f.MozTransitionDuration=f.msTransitionDuration=f.OTransitionDuration=f.transitionDuration=d+"ms",f.webkitTransform="translate(0,"+c+"px)translateZ(0)",f.msTransform=f.MozTransform=f.OTransform="translateY("+c+"px)")}}(Zepto);
!function(a){a.webPageReg={body:/<body[^>]*>([\s\S]*)<\/body>/i,style:/<style[^>]*>([\s\S]*)<\/style>/i,script:/<script\b[^<]*(?:(?!<\/script)<[^>]*)*<\/script>/gi}}(Zepto);